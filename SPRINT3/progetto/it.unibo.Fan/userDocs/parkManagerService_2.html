<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <!--
<link rel="stylesheet" type="text/css" href="../css/issStyle1.css">
<script type="text/javascript" src="../css/issStyle.js"></script>
-->
<style type="text/css">
body
{
    margin-left:  30px;
    margin-right: 30px;
};

P
{
    font-family: Tahoma;
    font-size: 10pt;
};

a, a:visited, a:active, a:link, a:hover {
    text-decoration: underline;
    color: #545454;
    background-color: transparent;
	font-size: 93%;
}

a:hover {
    background-color: #cccccc;
}


hr {
    clear: both;
    height: 1px;
    color: #242424;
    background-color: transparent;
}

h1, h2, h3 {
    color: #242424;
    clear: left;
    font: 100% Tahoma, Helvetica, Arial, sans-serif;
    margin-bottom: 0.5em;
    padding-top: 0.5em;
	border-radius: 10px;
	padding: 5px;
}

top {
	width: 100%;
}


#i {
    color: #ff1010;
}
tt{
	font-family: "Arial";
    font-size: 90%;
	color: #006600;
}
em{
	font-family: "Arial";
    font-size: 80%;
	font-weight: bold;
	border-style:solid;
	border-color: #abe876;
    color: #1632cc;
}
bc{
	font-family: "Arial";
	font-size: 90%;
	font-weight: bold;
    color: #990000;
	background-color: #fcf8c7;
}
ks{
	font-family: "Arial";
	font-weight: bold;
    color: #0000CD	;
	font-size: 90%;
}
kc{
	font-family: "Arial";
	font-weight: bold;
    color: #008000	;
	font-size: 90%;
}
pre{
	font-family: "Consolas";
	font-size: 85%;
	background-color: #f5f5f5;
	border: 1.5px solid silver;
	padding: 5px;
}
m{
	font-family: "Helvetica";
	line-height: 100%;
 	font-size: 75%;
}
div.body{
	 
    font-size: 18px;
}
k{
    color: #990000;
	font-weight: bold;
	font-size: 90%;
}
h1 {
    font-size: 150%;
    background-color: #b2c0ff;
	padding: 10px;
}

h2 {
    background-color: #9ed8ff;
    font-size: 130%;
}

h3 {
	background-color: #e6ccff;
    font-size: 100%;
}
h4 {
    background-color: #ccffcc;
    font-size: 100%;
	width: 95%;
	border-radius: 5px;
	padding: 2px;
}
h5 {
    background-color: #d5ffb0;
    font-size: 100%;

}
div.req{
	background-color: #d9ffb3;
    font-size: 18px;
	width: 700px;
    border: 3px solid green;
    padding: 15px;
    margin: 10px;
}
div.remark{
	background-color: #E3F2FD;
    border: 1.5px solid #d5f2ed;
    padding: 15px;
    margin: 10px;
	border-radius: 25px;
}
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}

ol, ul, li {
  margin: 0;
  margin-left: 10px;
  padding: 0;
  padding-bottom: 5px;
}

table, th, td {
	border: 1px solid black;
}

img {
	border: 1.5px solid #d5f2ed

}

a, a:visited, a:active, a:link, a:hover {
    text-decoration: underline;
    color: #545454;
    background-color: transparent;
}

div.wrapdesc{
	width: 90%;
	margin: auto;
}

div.imagedesc{
	width: 85%;
	margin: auto;
}
</style>
    
<head>
   
<title>parkManagerService_2</title></head>
    
<body>
<div id="top">
<h1>LABORATORIO DI INGEGNERIA DEI SISTEMI SOFTWARE <font size="5"></font> </h1>
</div>  

<div class="body"> 
<h2>Introduction</h2>
 
A company intends to build an <i>automating parking service</i> composed of a set of elements:

<ul>
<li>A software system, named <em>ParkManagerService</em>, that implements the required automation functions.</li>
<li>A <tt>DDR</tt> robot working as a <em>transport trolley</em>, that is intially situated in its <em>home</em> location. 
The <tt>transport trolley</tt> has the form of a square of side length <em>RD</em>.
</li>
<li>A <em>parking-area</em> is an empty room that includes;
	<ul>
	<li>an <em>INDOOR</em> to enter the car in the area. Facing the <tt>INDOOR</tt>, there is
	a <em>INDOOR-area</em> equipped with a <em>weigthsensor</em> that measures the <em>weigth</em> of the car;</li>
	<li>an <em>OUTDOOR</em> to exit from the <tt>parking-area</tt>. Just after the <tt>OUTDOOR</tt>, there is
	<em>OUTDOOR-area</em> equipped with a <em>outsonar</em>, used to detect the presence of a car.
	The <tt>OUTDOOR-area</tt>, once engaded by a car, should be freed within a prefixed interval of time <em>DTFREE</em>; </li>
	<li>a number <tt>N (N=6)</tt> of <em>parking-slots</em>;</li>
	<li>a <em>thermometer</em> that measures the temperature <em>TA</em> of the area;</li>
	<li>a <em>fan</em> that should be activated when <k>TA > TMAX</k>, where <em>TMAX</em> is a prefixed value (e.g. <tt>35</tt>)</li>
	</ul>
	A <em>map</em> of the parking area, represented as a grid of squares of side length <em>RD</em>, 
	is available in the file <a href="parkingMap.txt" target="code">parkingMap.txt</a>:
	<pre>
|r, 0, 0, 0, 0, 0, 0, X, 
|0, 0, <bc>X, X,</bc>  0, 0, 0, X, 
|0, 0, <bc>X, X,</bc>  0, 0, 0, X, 
|0, 0, <bc>X, X,</bc>  0, 0, 0, X, 
|0, 0, 0, 0, 0, 0, 0, X, 
|X, X, X, X, X, X, X, X, </pre>
	The map includes the positions of the  <tt>parking-slots</tt> (marked above with the symbol <k>X</k>) 
	and of the <em>fixed obstacles</em> in the area (the walls marked with the symbol <b>X</b>).
	<br/><br/>
	The area marked with <k>X</k> is a sort of 'equipped area' upon which the <tt>transport trolley</tt> cannot walk.
	Thus, to get the car in the <tt>parking-slot</tt> <ks>(2,2)</ks>, the <tt>transport trolley</tt> must
	go in cell <ks>(1,2)</ks>.
	<br/><br/>

	The proper scene for the WEnv is reported in: <a href="parkingAreaConfig.js" target="code">parkingAreaConfig.js</a>
 
	
	<center><img src="./img/parkingAreaZone.PNG" alt="parkingAreaZone.PNG" width="45%" height="32%"/></center>
</li>	
<li>a <em>parking-manager</em> (an human being) which supervises the state of the <tt>parking-area</tt>
and handles critical situations<!-- by using a software system named <em>ParkMonitoringService</em> -->. </li>
</ul>

<div class="remark">
The job of our company is to design, build and deploy the  <em>ParkManagerService</em>.
</div>

<h2>Requirements</h2>
 
<div class="remark">
The <tt>ParkManagerService</tt>  should create the <tt>ParkServiceGUI</tt> (for the client) 
and the <tt>ParkServiceStatusGUI</tt> (for the manager) and then perform the following tasks:


<ul>
 
<li><hr/>
<em>acceptIN</em>: accept the request of a client to park the car if there is at least one <tt>parking-slot</tt> available,
select a free slot identified with a unique <tt>SLOTNUM</tt>.<br/>
A request of this type can be elaborated only when the <k><tt>INDOOR-area</tt> is free</k>, 
and  the <tt>transport trolley</tt> is at <tt>home</tt> or working (<k>not stopped</k> by the manager). 
If the <tt>INDOOR-area</tt> is already engaged by a car, the request is not immediately processed 
(the client could simply wait or could - optionally - receive a proper notice). 
<br/>
  <li><em>informIN</em>: inform the client about the value of the <tt>SLOTNUM</tt>.</li> 
If  <k>SLOTNUM>0</k>:
  <ol>
   <li><em>moveToIn</em>: move the <tt>transport trolley</tt> from its current localtion to the <tt>INDOOR</tt> ;</li>
  <li><em>receipt</em>: send to the client a receipt including the value of the <tt>TOKENID</tt> ;</li> 
  <li><em>moveToSlotIn</em>: move the <tt>transport trolley</tt> from the <tt>INDOOR</tt> to the selected <tt>parking-slot</tt>;</li>
  <!-- <li>accept another request (<tt>acceptIN</tt> or <tt>acceptOUT</tt>). -->
  <li><em>backToHome</em>: if no other request is present,  move the <tt>transport trolley</tt> to its <tt>home</tt> location,
  else <em>acceptIN</em> or <em>acceptOUT</em>.</li> 
  </ol>
 </li>
If <k>SLOTNUM==0</k>: 
	<ul>
	<li><em>moveToHome</em>: if not already at home, move the <tt>transport trolley</tt> to its <tt>home</tt> location.</li> 
	</ul>
</li>


<li><hr/>
<em>acceptOUT</em>: accept the request of a client to get out the car with <tt>TOKENID</tt>.
A request of this type can be elaborated only when the <k><tt>OUTDOOR-area</tt> is free</k> 
and  the <tt>transport trolley</tt> is at <tt>home</tt> or working (<k>not stopped</k> by the manager).
If the <tt>OUTDOOR-area</tt> is still engaged by a car, the request is not immediately processed 
(the client could simply wait or could - optionally - receive a proper notice).

	<ol>
	<li><em>findSlot</em>: deduce the number of the parking slot (<em>CARSLOTNUM</em>) from the <tt>TOKENID</tt>;</li>
	<li><em>moveToSlotOut</em>: move the <tt>transport trolley</tt> from its current localtion to the <tt>CARSLOTNUM/parking-slot</tt> ;</li>
	<li><em>moveToOut</em>: move the <tt>transport trolley</tt> to the <tt>OUTDOOR</tt> ;</li>
	<li><em>moveToHome</em>: if no other request is present  move the <tt>transport trolley</tt> to its <tt>home</tt> location; <br/>
	else <em>acceptIN</em> or <em>acceptOUT</em></li> 

	</ol> 
</li>
<li>
<hr/>
<em>monitor</em>: update the <tt>ParkServiceStatusGUI</tt> with the required information about the state of the system.
</li>

<li>
<hr/>
<em>manage</em>: accept the request of the manager to stop/resume the behavior of the  <tt>transport trolley</tt>.
</li>

</ul>
<h4>About the devices</h4>
All the sensors (<tt>weigthsensor</tt>, <tt>outsonar</tt>, <tt>thermometer</tt> ) and the <tt>fan</tt> should be properly simulated
by mock-objects or mock-actors.

<h4>When using a real robot</h4>
No further requirement.

<h4>When available a Raspberry and a sonar</h4>
The <tt>outsonar</tt> could be a real device. We can simulate the presence/absence of a car.

    <h4>When using <k>only</k> the virtual robot or <k>no real sonar</k> available</h4>
Consider the new requirement:
<ul>
<li><ks>authorize</ks>: allow a manager to use the <tt>ParkServiceStatusGUI</tt> only if she/he owns <bc>proper permissions</bc>.</li>
 
</ul>

<h3>User stories</h3>
As a <bc>client - parking phase</bc> :
<ul>
<li>I intend to use a <em>ParkServiceGUI</em> provided by the <tt>ParkManagerService</tt>  to notify my interest in <i>entering</i> 
my auto in the <tt>parking-area</tt> and to receive as answer the number <em>SLOTNUM</em> of a  free parking-slot  (<tt>1&lt;=SLOTNUM&lt;=6</tt>). 
<tt>SLOTNUM<k>==0</k></tt> means that no free slot is available.</em>

</li>
<li>If <tt>SLOTNUM <k>>0</k></tt>, I move my car in front to the <tt>INDOOR</tt>, get out of the car and afterwards press a <em>CARENTER</em> button on the
<em>ParkServiceGUI</em>. Afterwards, the <tt>transport trolley</tt> takes over my car and moves it from the <tt>INDOOR</tt> 
to the selected <tt>parking-slot</tt>.
The <tt>ParkServiceGUI</tt> will show to me a receipt that includes a (unique) <em>TOKENID</em>, 
to be used in the <i>car pick up</i> phase.</li>
</ul>

As a <bc>client - car pick up phase</bc> :
<ul>
<li>I intend to use the <tt>ParkServiceGUI</tt> to submit the request to pick up my car, by sending the <tt>TOKENID</tt> previously received. </li>  
<li>Afterwards, the <tt>transport trolley</tt>  takes over my car and moves it from its <tt>parking-slot</tt> to the <tt>OUTDOOR-area</tt>.</li>
<li>I move the car, so to free the <tt>OUTDOOR-area</tt>.
</li>
 </ul>

As a <bc>parking-manager</bc>:
<ul>
<li>I intend to use the <em>ParkServiceStatusGUI</em>  provided by the <tt>ParkManagerService</tt>
to observe the <em>current state</em> of the <tt>parking area</tt>, including the value <tt>TA</tt> of the temperature,
the state of the <tt>fan</tt> and the state of the <tt>transport trolley</tt> (<k>idle, working or stopped</k>).</li>
<li>I intend to <em>stop</em> the <tt>transport trolley</tt> when <k>TA > TMAX</k>, activate the <tt>fan</tt> and 
wait until <k>TA &lt; TMAX</k>. At this time, I stop the <tt>fan</tt> and resume the behavior of the <tt>transport trolley</tt>.
Hopefully, the <b>start/stop</b> <ks>of the fan</ks> could also be automated by the <tt>ParkManagerService</tt>,
while the <b>start/stop</b> <ks>of the transport trolley</ks> is always up to me.
</li>

<li>I expect that the <tt>ParkManagerService</tt> sends to me an <em>alarm</em> if it detectes that the <tt>OUTDOOR-area</tt>
has not been cleaned within the <tt>DTFREE</tt> interval of time.</li>
</ul>

</div>

 

<h2>Requirement analysis</h2>
 
 In this <k>SPRINT</k> we will add the the application the <em>parking-manager</em> whith the relative GUI, <em>fan</em> and <em>thermomether</em>.
 Also we will work on the following requirements: <em>monitor</em>, <em>manage</em>. Also, if possible we would we will perform the analysis to activate the <em>fan</em> automatically. 
 <br>
 <br>
 At the end of this <k>SPRINT</k> the <tt>parking-manager</tt> will be able to interact with the <em>ParkServiceStatusGUI</em>. Shoudl be able to notify the 
 <tt>park-manager</tt> if a <tt>client</tt> has not left the <em>OUTDOOR-area</em> whithin the <em>DTFREE</em> interval of time. Also, the <tt>park-manager</tt> can stop and resume the
 <tt>transport trolley</tt>.
 </div>
 <br>
 Note: optional parts will not be discussed at this stage and will be implemented at the end.
 <br>
 <br>
 Other term to clarify:
 <ul>
	<li><em>alarm</em>: a video notice in the graphic interface that signal the <tt>park-manager</tt> that after <tt>DTFREE</tt> the <tt>OUTDOOR</tt> is still occupied
	 by a car.</li>
 </ul>
 <br>
 In this <k>SPRINT</k> we will consider only the following use-cases:
 <h4>Use-case <ks>The <k>TA</k> measured by the <tt>thermometer</tt> is increased over <k>TMAX</k></ks></h4>
 The application should be able, in order, to: 
 <br>
 <ol>
	<li>Check if the temperature measured by the <em>thermomether</em> is above <k>TMAX</k>.</li>
	<li>Send the <em>alarm</em> to the <em>parking-manager</em>.</li>
	<li>Activate the <em>fan</em>.</li>
	<li>The <em>parking-manager</em> stops the <em>Transport Trolley</em>.</li>
	<li>Check if the temperature measured by the <em>thermomether</em> is below <k>TMAX</k>.</li>
	<li>Notify the <em>parking-manager</em>.</li>
	<li>Deactivate the <em>fan</em>.</li>
	<li>The <em>park-manager</em> starts the <em>Transport Trolley</em></li>
 </ol>
 <h4>Use-case <ks><tt>OUTDOOR-area</tt> is not free whithin <tt>DTFREE</tt></ks></h4>
 The application should be able, in order, to: 
 <br>
 <ol>
 	<li>Check if the <em>OUTDOOR-area</em> monitored by the <em>outsonar</em> is <tt>occupied</tt> for a time above <k>DTFREE</k>.</li>
	<li>Notify the <em>parking-manager</em>.</li>
	<li>Wait until the <em>OUTDOOR-area</em> is <tt>free</tt>.</li>
 </ol>

<h2>Problem analysis</h2>
   Following the work on the previous <k>SPRINT</k>: link doc1, link doc2.  We will use QaKActor to develop the component in the distributed environment.
   
   <h3><ks>Park-manager GUI</ks> Requirement: <em>monitor</em></h3>
   <table style="width:100%" border="1">
		<tr>
			<td style="width:50%">
			   We need a graphic interface able to:
				<ul>
					<li>Shows the <em>current state</em> of the parking area:
						<ul>
							<li>Value of the temperature <tt>TA</tt>.</li>
							<li>State of the <tt>fan</tt> (on/off).</li>
							<li>State of the <tt>trolley</tt> (<k>idle, working, or stopped</k>). </li>
							<li><ks>Optionally</ks> other helpful information such as the current robot position or the map.</li>
						</ul>
					</li>
					<li>Send a <ks>stop</ks> command to the <tt>trolley</tt> when <k>TA>TMAX</k>.</li>
					<li>Show a visual notice when <tt>TA</tt> surpasses <tt>TMAX</tt> and when <tt>TA</tt> goes below <tt>TMAX</tt>.</li>
					<li>Show a visual notice if the <em>OUTDOOR-area</em> has not been cleaned within the <tt>DTFREE</tt> interval of time, and
						hide it after it returns <tt>free</tt>.</li>
				</ul>
				<br>
				To grant wide usability the system should be developed as a Web-application. 
				<br>
				<k>Springboot</k> should be used to reduce development time. (link info/ previous projects)
			</td>
			<td>
				<img src="img\parkservicestatusGui_example.png" width="80%" height="80%">
			</td>
		</tr>
	</table>
   <br>
   <h3>Current state of the system</h3>
   Becaue we have multiple resource that are source of data and a couple of actors that uses multiple of them we need to discuss the best way to make them avaiable.
   There are different approaches we can take:
	<table style="width:100%" border="1">
		<tr>
			<td style="width:50%">
			<tt>ParkmanagerService</tt> itself Store the system informations as a CoAP Observable entity
			</td>
			<td>
				<dl>
					<dt><k><tt>Pro</tt></k>:</dt> 
					<dd>No new component is introduced.</dd>
					<dd>ParkServiceStatusGUI only observe one actor.</dd>
					<dt><k>Cons</k>:</dt> 
					<dd>Increased ParkManagerService complexity.</dd>
				    <dd>Adding a new resource means modify our core element application.</dd>
				    <dd>.</dd>
				</dl>
			</td>
			
		</tr>
		<tr>
			<td style="width:50%">
			Add a new actor that contains the current state of the system as a CoAp Observable entity
			</td>
			<td>
				<dl>
					<dt><k><tt>Pro</tt></k>:</dt> 
					<dd>Do not overload ParkmanagerService.</dd>
					<dd>Adding a new resource means modifyng only the state component and the observer.</dd>
					<dd>Simplyfing overall archietecture.</dd>
					<dd>One resource can be be used by multiple actors.</dd>
					<dt><k>Cons</k>:</dt> 
					<dd>Not strictly necessary.</dd>
				    <dd>.</dd>
				    <dd>.</dd>
				</dl>
			</td>
		</tr>
		<tr>
			<td style="width:50%">
			Every actor observe the resource they are interested in
			</td>
			<td>
				<dl>
					<dt><k><tt>Pro</tt></k>:</dt> 
					<dd>No new elements.</dd>
					<dd>Each component can observed only the resource they need.</dd>
					<dt><k>Cons</k>:</dt> 
					<dd>Double code for each observing component.</dd>
				    <dd>ParkServiceStatusGUI has to know every entity in the system.?</dd>
				    <dd>Complex architacture.</dd>
				</dl>
			</td>
			
		</tr>
	</table>
	
	So it is preferred to add a new State component ...
<!--
 
 <h3>Temperature check and fan activation</h3>
	We need to introduce two new element: fan and thermometer. We need to activate the fan when TA>TMAX and give a notice to the <tt>park-manager</tt>.
	There are different methods:
  <table style="width:100%" border="1">
		<tr>
			<td style="width:50%">
			Thermometer send event when TA>TMAX and when TA<TMAX
			</td>
			<td>
				<dl>
					<dt><k><tt>Pro</tt></k>:</dt> 
					<dd>Reach every component, without the need to know them.</dd>
					<dd>?.</dd>
					<dt><k>Cons</k>:</dt> 
					<dd>Logic inside the thermometer.</dd>
				    <dd>No reusability.</dd>
				</dl>
			</td>
		</tr>
		<tr>
			<td style="width:50%">
			Fan, ParkServiceStatusGUI and ParkManagerService observe TA and act consequently
			</td>
			<td>
				<dl>
					<dt><k><tt>Pro</tt></k>:</dt> 
					<dd>?.</dd>
					<dt><k>Cons</k>:</dt> 
					<dd>?.</dd>
				    <dd>?.</dd>
				</dl>
			</td>
		</tr>
		<tr>
			<td style="width:50%">
			Actor with the logic
			</td>
			<td>
				<dl>
					<dt><k><tt>Pro</tt></k>:</dt> 
					<dd>?.</dd>
					<dt><k>Cons</k>:</dt> 
					<dd>?.</dd>
				    <dd>?.</dd>
				</dl>
			</td>
		</tr>
	</table>
 -->
 <h3>Components</h3>
 We can add to the application 4 macro-components:
 <ul>
	<li><ks>ParkingState</ks>: used to keep the current state of the system.</li>
	<li><ks>ParkManagerStatusGUI</ks>: used by the <tt>park-manager</tt> to comunicate with the <tt>ParkmanagerService</tt>.</li>
	<li><ks>Thermometer resource</ks>: a resource that receives, stores, and makes available the data from the <em>thermometer</em>.</li>
	<li><ks>Fan</ks>: a resource that activate the <em>fan</em>.</li>
 </ul>
 We need to modify 2 components:
  <ul>
	<li><ks>Transport trolley</ks>: add the state <k>idle, working or stopped</k>.</li>
	<li><ks>Sonar</ks>: add the logic to notify the <tt>park-manager</tt> after <tt>DTFREE</tt>.</li>
 </ul>
 <h4>Parking state</h4>
 This component can observe every resource in our application a make those information avaiable as a CoAp observable resource.
 
 We could change the CoAp observcable state of this component using a String as a JSON. (pro: wide usability )
 
 <h4>ParkManagerStatusGUI</h4>
 Mock used to simulate the park-manager in the model.
 Should be able to:
 <ol>
	<li>Send stop/start messages to the trolley.</li>
	<li>Observe the current state of the parking slot.</li>
	<li>Being notifed if OUTDOOR is occupied for a time > DTFREE</li>
 </ol>
 
 <h4>Trolley</h4>
  We can define this component as CoAp observable and change the state with: idle, working, or stopped.
  
 <h4>Sonar</h4>
 We need to modify this resource, or at least add logic to notify ...
 We need to send an Event to the parking-manager visible on the <em>ParkServiceStatusGUI</em> if the <em>OUTDOOR-area</em> has not been cleaned within <tt>DTFREE</tt> interval of time.
 There are different approach we can take:
 <table style="width:100%" border="1">
		<tr>
			<td style="width:50%">
			Sonarresource sends an events after <tt>DTFREE</tt> time
			</td>
			<td>
				<dl>
					<dt><k><tt>Pro</tt></k>:</dt> 
					<dd>Easy to realize.</dd>
					<dt><k>Cons</k>:</dt> 
					<dd>Logic inside the sensor.</dd>
				    <dd>Hard reusability.</dd>
				</dl>
			</td>
		</tr>
		<tr>
			<td style="width:50%">
			Adding an external actor with the logic
			</td>
			<td>
				<dl>
					<dt><k><tt>Pro</tt></k>:</dt> 
					<dd>Separate the logic from the other components.</dd>
					<dt><k>Cons</k>:</dt> 
					<dd>Not strictly needed.</dd>
					<dd>Extra actor to consider and interact with.</dd>
				</dl>
			</td>
		</tr>
	</table>
 
 Both of this option are avaiable, to simplify the model the first option is chosen to include in the model after the Analisys, but during the project phase
 the choice is left based on the type of architecture adopted.
 
 
 <h4>Thermometer</h4>
 
 <h4>Fan</h4>
 
 <h3>Other relevant aspects</h3>

  <h4>Trolley start and stop Requirement: <em>manage</em></h4>
 ParkServiceStatusGUI send a dispatch to the ParkManager that propagate it to the trolley.
  Why dispatch?
 Why parkmanagersrviceand not idrectely to the trolley?
 
 <h4>Temperature check and fan activation</h4>
	We need to introduce two new element: fan and thermometer. We need to activate the fan when TA>TMAX and give a notice to the <tt>park-manager</tt>.
	There are different methods:
  <table style="width:100%" border="1">
		<tr>
			<td style="width:50%">
			Thermometer send event when TA>TMAX and when TA<TMAX
			</td>
			<td>
				<dl>
					<dt><k><tt>Pro</tt></k>:</dt> 
					<dd>Reach every component, without the need to know them.</dd>
					<dd>?.</dd>
					<dt><k>Cons</k>:</dt> 
					<dd>Logic inside the thermometer.</dd>
				    <dd>No reusability.</dd>
				</dl>
			</td>
		</tr>
		<tr>
			<td style="width:50%">
			Fan, ParkServiceStatusGUI and ParkManagerService observe TA and act consequently
			</td>
			<td>
				<dl>
					<dt><k><tt>Pro</tt></k>:</dt> 
					<dd>?.</dd>
					<dt><k>Cons</k>:</dt> 
					<dd>?.</dd>
				    <dd>?.</dd>
				</dl>
			</td>
		</tr>
		<tr>
			<td style="width:50%">
			Actor with the logic
			</td>
			<td>
				<dl>
					<dt><k><tt>Pro</tt></k>:</dt> 
					<dd>?.</dd>
					<dt><k>Cons</k>:</dt> 
					<dd>?.</dd>
				    <dd>?.</dd>
				</dl>
			</td>
		</tr>
	</table>
 In the model for simplicity we decide to add the logic to the Thermometer, other option are open to be implemented based on the Architacture chosen in the project phase.

 <h3>Logical architecture</h3>
 
 <img src="img\LogicalArchitecture_2.png" width="100%">
 <br>
 <br>
 See here the <a href="img\legenda.png" target="img">Legenda</a>.
 <br>
 <br>
 <k>Model built with QAkActors</k> <a href="../src/park_service_model_2.qak" target="web">here</a>.
 <!--
	<li>How does the <tt>ParkManagerService</tt> makes sure that during the client interaction between the request to enter and the carenter message, the slot is given to the same client?
	A client could receive the SLOTNUM, then not send a carenter. 
	<br>
	At the moment is assumed that the client always sends a carenter request, so the system keeps the slot occupied after the first request to park. 
	</li>
 -->
 <br>
 <h3>Expected Time</h3>
 Starting from the model already built, the first protoype is expected to be developed in 3 days of work.
<h2>Test plans</h2> 

<h4>Use-case <ks>The <k>TA</k> measured by the <tt>thermometer</tt> is increased over <k>TMAX</k></ks></h4>
 We can send a temperature above, then below, TMAX and simulate a park-manager that stop and start the trolley. Also while the trolley is stopped we can simulate clients
requests. To check if the test if succesful we need to observe the fan and the trolley state, while also checking that while stopped the trolley doen't move.
<br> 
 To check if the test is successful we need to observe the trolley movement and the message exchange between the application and the client.
 <br><br>
 Requirements: <em>manage</em>.
 <br><br>
 <ks>Starting conditions:</ks>
 <ul>
	<li><tt>Transport Trolley</tt> is <tt>home</tt>.</li>
	<li><tt>Transport Trolley</tt> is not stopped.</li>
	<li><tt>Fan</tt> is off.</li>
 </ul>
 
 We expect that, in order:
 <ol>
	<li>The <tt>trolley</tt> state changes to "stopped".</li>
	<li>The <tt>fan</tt> state changes to "on".</li> 
	<li>The <tt>trolley</tt> state changes to "idle".</li>
	<li>The <tt>fan</tt> state changes to "off".</li>
	Also we can check that the trolley doesn't move while stopped, but moves when is started again.
 </ol>
 <p>JUnit test: <a href="../src/test/TestPlanUseCase1.kt">TestPlanUseCase1.kt</a>, <a href="../src/test/TestPlanUseCase1RobotPos.kt">TestPlanUseCase1RobotPos.kt</a>
 <br>
 <h4>Use-case <ks><tt>OUTDOOR-area</tt> is not free whithin <tt>DTFREE</tt></ks></h4>
  We can simulate to occupy the <tt>OUTDOOR</tt> and wait a time over <tt>DTFREE</tt>. 
  To check if the test is successful we need to observe the event sent by the sonar.
  <br><br>
   Requirements: <em>alarm</em>.
 <br><br>
  <ks>Starting conditions:</ks>
  <ul>
	<li><em>OUTDOOR-area</em> is free.</li>
  </ul>
 
 We expect that:
 <ol>
	<li>sonar send an event</li>
 </ol> 
 <p>JUnit test: <a href="../src/test/TestPlanUseCase2.kt">TestPlanUseCase2.kt</a></p>

<h2>Project</h2> 
 D:\Scuola\Registrazioni\Ing\ultimeLezioni -> lezione 20210601 per clean architecture
 
 <h3>Clean architecture</h3>
 https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html
 
 refactory code
 
 Entities: weightsensor, sonarsensor, thermometer, fan
 <br>
 <br>
 Use-case: weightsensorlogic, sonarlogic, thermometer logic, fan logic, trolley logic?
 <br>
 <br>
 Interfaces:
 <br>
 <br>
 frameworks
 <h4>weightsensor refactory</h4>
 <table style="width:100%" border="1">
	<tr>
		<td style="width:50%">
			img
		</td>
		<td>
			explanation ...
		</td>
	</tr>
</table>
<h4>sonarsensor refactory</h4>
 <table style="width:100%" border="1">
	<tr>
		<td style="width:50%">
			img
		</td>
		<td>
			explanation ...
		</td>
	</tr>
</table>
<h4>thermometer/fan</h4>
 <table style="width:100%" border="1">
	<tr>
		<td style="width:50%">
			img
		</td>
		<td>
			explanation ...
		</td>
	</tr>
</table>
<h4>trolley?</h4>
 <table style="width:100%" border="1">
	<tr>
		<td style="width:50%">
			img
		</td>
		<td>
			explanation ...
		</td>
	</tr>
</table>
 
 <img src="img\ConcreteArchitecture_2.png" width="100%">

<h2>Testing</h2> 
 

<h2>Deployment</h2> 

 
<h2>Maintenance</h2> 
 
<!-- USEFUL
<table style="width:100%" border="1">
<tr>
<td style="width:50%">
</td>
<td></td>
</tr>
</table>
-->
	      	
<br/><br/> 	
</div>  

<div style="background-color:rgba(86, 56, 253, 0.9); width:60%;text-align:left;color:white;overflow: auto">
By Emanuele Paci email: emanuele.paci@studio.unibo.it
<br/>
Repository: https://github.com/empaci/Paci-Emanuele-Progetto-Finale-ISS2021
<img src="img\fototessera.png" alt="foto" width="15%" height="15%" style="float:right;">
</div> 
</body>
</html>